## Domain 2.0 Vulnerability Management

Vulnerability management programs seek to identify, prioritize, and remediate these vulns before an attacker exploits them and comps one of the CIA of an information asset. Organized approach to scanning assets for vulns and using a defined workflow to remediate those vulns and preform contiued assesments to provide insight into the current state of the networks cybersecurity.

While a vuln mgmt plan is being developed, you need to first identify any internal or external requirements for vuln scanning. These may be regulatory environments where the org operates and/or internal policy-driven requirements.

 <details>
 <summary>Regulatory Environment</summary>
 <br>
 
 Laws and regulations that govern how to store, process, and transmit info. Like handeling sensitive personal info or info belonging to gov agencies. 
HIPPA(Health Insurance Portability and Accountability Act, how to handle health info)  and the GLBA(Gramm-Leach-Bliley Act, how financial inst. may handle cust financial records) do not specifically address the implementation of a vuln mgmt program, they dont state that vuln scanning is required.

The PCI(Payment Card Industry Data Security Standard) and FISMA(Federal Info Security Mgmt Act) do mandate the implementation of a vuln mgmt program.

These two cover org involved in processing retail tansactions and operating gov systems, this only covers a fraction of the enterprise. It is widely agreed that vuln mgmt is a critical component of any info security program, for this many org mandate vuln scanning in corporate policy , even if not imposed by regulatory requirements.

<details>
  <summary>PCI DSS(Payment Card Industry Data Security Standard)</summary>
  <br>
  - This is NOT a LAW, is maintained by the PCI SSC(Payment Card Industry Sec Standards Council) funded by industry to maintain req
  - Those subject to PCI DSS are by contract not law
  Specific security controls for merchs who that handle CC transactions and providers that assists with them. Includes arguably the most specific req for vuln scanning. 
  
  ## Included details for vuln scans
    - ORG must run internal and external scan (req 11.2)
    - run scans at least quarterly and after significant changes to network (new FW rule, system upgrade, new component (req 11.2)
    - Internal scans ran by qualified personal (req 11.2.1)
    - Org must remediate and high risk vuln and repeat scan to confirm they are resolved until a clean scan report (req 11.2.1)
    - External scan done by Approved Scanning Vendor (ASV) auth by PCI SSC (req 11.2.2) (many org may conduct their own scans first to assure of a passing grade)
  </details>

<details>
  <summary>FISMA(Federal Information Security Management)</summary>
  <br>
  Security standards for gov agencies & Org on behalf of gov. The specific standards depend on if the gov designates the system as low, moderate, or high impact according to chart below. Furhter guidance in Federal Info Process Standards (FIPS) 199.
    
   [![Capture.png](https://i.postimg.cc/DfsWPfr9/Capture.png)](https://postimg.cc/WtNb2vf8)
  
 
  All federal info systems regardless of impact must meet the basic req for vuln scanning found in NIST Special Publication 800-53: Security and Privacy Controls for Federal Info Systems and Orgs. These req that each org subject to FISMA:
  
  a. Scans for vulns in the info system and hosted apps when new vulns potentually affecting the system/app are reported
  
  b. Employ vuln scan tool and techniques that make it easier to have the systems tools work together and automate vuln mgmt process by using standards for:
    1. Enumerating paltforms, software flaws, & improper configs
    2. formatting checklist & test proc
    3. Measuring vuln impact
    
  c. Analyze vuln scan reportand results from sec control assessments.
 
  d. Remediate legit vuln in accordance wih an org assessment of risk
  
  e. Shares info obtained from the vuln scan process and sec control assessment to help eliminate similar vulns in other info systems (i.e systemic weakness or deficiencies)
  
  */ These req est a baseline for all federal info sys. /* 
  
  NIST 800-53 then desc 8 control enhancements that may be req depending on the situation.
  
   1. Org uses vuln scan tools that include the ability to readily update the info systems vulns to be scanned
   2. Org updates vulns scanned prior to a new scan and/or when new vulns are identified and reported.
   3. Org employs vuln scanning procs that can identify the breadth and depth of coverage(i.e info system components scanned and vulns checked)
   4. Org determines what info about info systems is discoverable b adversaries and then takes org defined corrective actions.
   5. Info system implements priv access auth to info system components for selected vuln scanning activities.
   6. Org employs automated mechanisms to compare the results of vuln scans over time to determine trends in info system vulns.
   8. Org reviews historic audit logs to determine if an identified vuln has been previously exploited.
   10. Org correlates the output from vuln scanning tools to determine the resence of multi-vuln/ multi-hop attack vectors.
   
   */ req 7 & 9 were control enhancements that were once included but since have been with drawn. /*
   
   If federal agency determines an info system falls under the moderate impact, it must implement 1,2, and 5 at a minimum
   If it falls under high impact then 1,2,4, and 5.
  </details>
</details>


An organization has decided to conduct a vulnerability scan:
 - must check if they fall under any regulatory requirments
 - next step is to identify targets covered in the scan
 - some choose all where as some choose based on the following questions
   - data classicfication of data being stored, processed or stored?
   - Is there system exposed to the internet/public/semi-public networks?
   - what service is offered on the system?
   - Is the system prod, test, or dev?

Orgs may use automated ways to identify systems that may be coverd in a scan. May use tools to search the network for connected systems wheather previously known or not. They then can build an asset inventory. QualysGuard offers such a function called asset map. Then adding info the the assets in the map. Asset info and critical info helps guide the types of scans and there freq as well as priority admins shoud place on the vulns detected in the scan. Orgs may decide to automate vuln scans and should also have automated alerting when vulns are detected. The freq of these scans can be influenced by factors such as */ risk appetite /* , willingness to tolerate risk, being how freq to run scans to minimize time in between when a vuln is discovered and detected by scan. Regulatory req, corporate policy. Technical constraints, scanning system may only be able to preform a certain amount of scans in a day, need to adjust to preform all scans properly. Business contraints may limit resource intensive scans from being conducted during periods of high buisness activty. Licensing Limitations may curtail the bandwidth or number of scans that can be conducted simultaneously.

Must balance each of these when planning. Wise to start small and slowly expan the scope & freq of the scan over time to avoid overwhelming the scanning infrastructure or enterprise systems.

<details>
 <summary>Configuring and Executing Vulnerability Scans</summary>
 <br>
 After determining the basic req for their vuln scan mgmt program, then you must config the vuln mgmt tools to preform the scans according to the req-based scan specs. This includes scopes for the scans, configs to meet the orgs reqs, and maintain the currency of the vuln scan tool. 
 
 ### Scope
 
   Scope describes the extent of the scan like what systems and networks will be included, what technical measures will be used to test whether the systems are present on the network, and what tests will be preformed against systems discovered by a vuln scan. Admins should answer these along with technical staff to insure this is appropriate and unlikely to cause disruption to business, then move onto configuring the vuln mgmt tool. Scoping for regulations can be reduced to a manageable size by scanning for say PCI DSS for the whole enterprise can be tough, so properly segmenting the network and only scanning devices that handle that data can make it more manageable and ensure it has been done properly, reducing the controls in place and scope to focus on systems that actually engage in card processing. This will reduce cost of scanning and remediation workload. 
   
  ### Configuring scans
  
   Vuln mgmt solutions have plently of parameters: scheduling scans & reports, types of checks, credential scans, install scannign agents on servers, and have network presepectve scans. Pay careful attention to settings related to scan sev lvls, these will determine the types of checks the scanner will preform and should be customized to keep inline with objectives and not disrupt target env. Templates help efficiancy. Each plug-in preforms a check for a specific vuln, these often are grouped into a family based on the OS, app, or involved device. You can dissable unnecessary plug-ins to improve speed of the scan, this may also reduce FPs. Example, Org may not use Amazon Linux OS, so you disable all plug-ins related to checking that OS. Some plug-ins may cause damage or disrupt content on a system, this can be bad on a prod device, so having a test env is where these plug-ins are preformed. If something using these plug-ins is detected in the test, then can be corrected in prod. 
   
   Remote vuln scans may report false or skewed info due to firewalls, IDS/IPS, or other devices in between. To help with this you can supplement these remote scanners with info on the target. One way is providing the scanner with creds to the target to grab config info and detecting vulns that way improving over a noncred scan (Scanner will only retreive info and does not make any changes, but enforce principle of least priv by providing the scanner with read only to reduce the likleyhood of incident related to the scanners access). Or Installing agents on the target or an "inside out" vuln scan and report back to the management platform for analysis. Test agent based carefully as it may hinder preformance depending on what the system does. 
  
 ### Scan perspective
 
   Vuln mgmt tools provide the ability to conduct scans from a variety of scan perspectives such as External(from internet), Internal (may be ran from Corp network), and Inside the DC itself to show vulns that might have been blocked by security controls on the network. 
   
   Vuln mgmt solutions should have regualr updates and maintinance. This may be new plug-ins(updates can be scheduled) or updates to the vuln software itself, as it can contain vulnerabilites as well. 
   
   
  ### SCAP
  
   Security Content Automation Protocol is an effort by the security community led by NIST to create a standard way communicate security-related info. Important to the automation of interactions between security components. SCAP includes:
   
   - CCE Common Config Enumeration (nomenclature for discussing config issues)
   
   - CPE Common Platform Enumeration (nomenclature for desc product names and versions)
   
   - CVE Common Vuln and Exposures (nonmenclature for desc security related software flaws)
   
   - CVSS Common vuln Scoring System ( for measuring and desc sev of seecurity related software flaws)
   
   - XCCDF Extensible Config Checklist Desc Format (language for specifying checklist and reporting checkist results)
   
   - OVAL Open Vuln and Assessment Language (language for specifying lowlevel testing proc used by checklists)
   
   **For more see NIST SP 800-117: guide ot using SCAP**
   
   ### Developing a Remediation Workflow
   
    
   
   
   
   
 </details>





Template

<details>
  <summary></summary>
  <br>
  </details>
